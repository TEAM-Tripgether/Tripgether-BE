# ===================================================================
# Spring Boot Dockerfile
# ===================================================================
# 
# ğŸ“ ì„¤ëª…:
# - Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ë©€í‹° ìŠ¤í…Œì´ì§€ Dockerfile
# - ë¹Œë“œ ê²°ê³¼ë¬¼(app.jar)ì„ ê²½ëŸ‰í™”ëœ ëŸ°íƒ€ì„ ì´ë¯¸ì§€ë¡œ ì‹¤í–‰
# 
# ğŸ”§ ë¹Œë“œ êµ¬ì¡°:
# - Gradle ë¹Œë“œ ì‹œ build/libs/app.jar ìƒì„± ê°€ì •
# - Java 17 ê¸°ë°˜ ëŸ°íƒ€ì„ í™˜ê²½
# 
# ===================================================================

# ===================================================================
# ëŸ°íƒ€ì„ ìŠ¤í…Œì´ì§€
# ===================================================================
FROM eclipse-temurin:17-jre-alpine

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# ë¹Œë“œëœ JAR íŒŒì¼ ë³µì‚¬
# Gradle ë¹Œë“œ ì‹œ build/libs/app.jar íŒŒì¼ì´ ìƒì„±ëœë‹¤ê³  ê°€ì •
COPY build/libs/app.jar app.jar

# íƒ€ì„ì¡´ ì„¤ì • (Asia/Seoul)
RUN apk add --no-cache tzdata && \
    cp /usr/share/zoneinfo/Asia/Seoul /etc/localtime && \
    echo "Asia/Seoul" > /etc/timezone && \
    apk del tzdata

# í¬íŠ¸ ë…¸ì¶œ (Spring Boot ê¸°ë³¸ í¬íŠ¸)
EXPOSE 8080

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
# JVM ì˜µì…˜:
# - Xms512m: ì´ˆê¸° í™ ë©”ëª¨ë¦¬ 512MB
# - Xmx1024m: ìµœëŒ€ í™ ë©”ëª¨ë¦¬ 1GB
# - í•„ìš”ì— ë”°ë¼ ì¡°ì • ê°€ëŠ¥
ENTRYPOINT ["java", "-Xms512m", "-Xmx1024m", "-jar", "app.jar"]

# ===================================================================
# ì‚¬ìš© ë°©ë²•
# ===================================================================
#
# 1. Gradle ë¹Œë“œ:
#    ./gradlew clean build -x test
#
# 2. Docker ì´ë¯¸ì§€ ë¹Œë“œ:
#    docker build -t your-project-name:latest .
#
# 3. Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰:
#    docker run -d -p 8080:8080 \
#      -e SPRING_PROFILES_ACTIVE=prod \
#      your-project-name:latest
#
# ===================================================================
